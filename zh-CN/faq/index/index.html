<!doctype html>
<html class="docs-version-current" lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache Linkis Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache Linkis Blog Atom Feed"><title data-react-helmet="true">Q&amp;A | Apache Linkis</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://linkis.apache.org/zh-CN/faq/index"><meta data-react-helmet="true" name="docusaurus_locale" content="zh-CN"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-faq-current"><meta data-react-helmet="true" property="og:title" content="Q&amp;A | Apache Linkis"><meta data-react-helmet="true" name="description" content="Linkis1.0常见问题和解决办法"><meta data-react-helmet="true" property="og:description" content="Linkis1.0常见问题和解决办法"><link data-react-helmet="true" rel="shortcut icon" href="/zh-CN/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://linkis.apache.org/zh-CN/faq/index"><link data-react-helmet="true" rel="alternate" href="https://linkis.apache.org/faq/index" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://linkis.apache.org/zh-CN/faq/index" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://linkis.apache.org/faq/index" hreflang="x-default"><link rel="stylesheet" href="/zh-CN/assets/css/styles.b20f1446.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.d57539bc.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.8f734cad.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" style="background-color:#BBDFFF" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">⭐️ &nbsp; If you like Apache Linkis , give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/apache/incubator-linkis">GitHub</a></div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><img src="/zh-CN/img/logo.png" alt="Apache Linkis Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/zh-CN/img/logo.png" alt="Apache Linkis Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Apache Linkis(Incubating)</b></a><a class="navbar__item navbar__link" href="/zh-CN/">首页</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-CN/faq/index">FAQ</a><a class="navbar__item navbar__link" href="/zh-CN/download/index">下载</a><a class="navbar__item navbar__link" href="/zh-CN/community/how-to-contribute">社区</a><a class="navbar__item navbar__link" href="/zh-CN/team">团队</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link">文档</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/docs/next/introduction">Next(1.0.3)</a></li><li><a class="dropdown__link" href="/zh-CN/docs/introduction">1.0.2</a></li><li><a class="dropdown__link" href="/zh-CN/versions/">All versions</a></li></ul></div><a href="https://github.com/apache/incubator-linkis" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg t="1631348384596" class="iconLanguage_EbrZ" viewBox="0 0 1024 1024" version="1.1" p-id="557" width="20" height="20"><path d="M547.797333 638.208l-104.405333-103.168 1.237333-1.28a720.170667 720.170667 0 0 0 152.490667-268.373333h120.448V183.082667h-287.744V100.906667H347.605333v82.218666H59.818667V265.386667h459.178666a648.234667 648.234667 0 0 1-130.304 219.946666 643.242667 643.242667 0 0 1-94.976-137.728H211.541333a722.048 722.048 0 0 0 122.453334 187.434667l-209.194667 206.378667 58.368 58.368 205.525333-205.525334 127.872 127.829334 31.232-83.84m231.424-208.426667h-82.218666l-184.96 493.312h82.218666l46.037334-123.306667h195.242666l46.464 123.306667h82.218667l-185.002667-493.312m-107.690666 287.744l66.56-178.005333 66.602666 178.005333z" fill="currentColor" p-id="558"></path></svg><span>简体中文</span></span></a><ul class="dropdown__menu"><li><a href="/faq/index" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh-CN/faq/index" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">简体中文</a></li></ul></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/zh-CN/faq/index">Q&amp;A</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Q&amp;A</h1></header><p>Linkis1.0常见问题和解决办法
：<a href="https://docs.qq.com/doc/DWlN4emlJeEJxWlR0" target="_blank" rel="noopener noreferrer">https://docs.qq.com/doc/DWlN4emlJeEJxWlR0</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q1linkis启动报错nosuchmethoderrorgetsessionmanagerlorgeclipsejettyserversessionmanager"></a>Q1、linkis启动报错：NoSuchMethodErrorgetSessionManager()Lorg/eclipse/jetty/server/SessionManager<a class="hash-link" href="#q1linkis启动报错nosuchmethoderrorgetsessionmanagerlorgeclipsejettyserversessionmanager" title="Direct link to heading">#</a></h4><p>具体堆栈： </p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">Failed startup of context o.s.b.w.e.j.JettyEmbeddedWebAppContext@6c6919ff{application,/,[file:///tmp/jetty-docbase.9102.6375358926927953589/],UNAVAILABLE} java.lang.NoSuchMethodError: org.eclipse.jetty.server.session.SessionHandler.getSessionManager()Lorg/eclipse/jetty/server/SessionManager;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.eclipse.jetty.servlet.ServletContextHandler\$Context.getSessionCookieConfig(ServletContextHandler.java:1415) ~[jetty-servlet-9.3.20.v20170531.jar:9.3.20.v20170531]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>解法：jetty-servlet 和 jetty-security版本需要从9.3.20升级为9.4.20；</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q2启动微服务linkis-ps-cs时报debuggclasswriter-overrides-final-method-visit"></a>Q2、启动微服务linkis-ps-cs时，报DebuggClassWriter overrides final method visit<a class="hash-link" href="#q2启动微服务linkis-ps-cs时报debuggclasswriter-overrides-final-method-visit" title="Direct link to heading">#</a></h4><p>具体异常栈：</p><p><img alt="linkis-exception-01.png" src="/zh-CN/assets/images/linkis-exception-01-3ce5a64d164882814935b610d226d5d6.png"></p><p>解法:jar包冲突，删除asm-5.0.4.jar;</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q3启动微服务linkis-ps-datasource时jdbcutilsgetdriverclassname-npe"></a>Q3、启动微服务linkis-ps-datasource时，JdbcUtils.getDriverClassName NPE<a class="hash-link" href="#q3启动微服务linkis-ps-datasource时jdbcutilsgetdriverclassname-npe" title="Direct link to heading">#</a></h4><p>具体异常栈：</p><p><img alt="linkis-exception-02.png" src="/zh-CN/assets/images/linkis-exception-02-70fdd83cebfd9f535617f4ada1aa0e66.png"></p><p>解法：Linkis-datasource 配置问题导致的，修改linkis.properties  hive.meta开头的三个参数：</p><p><img alt="hive-config-01.png" src="/zh-CN/assets/images/hive-config-01-38139d9e535f185bee3e17535a5ec327.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q4启动微服务linkis-ps-datasource时报如下异常classnotfoundexception-httpclient"></a>Q4、启动微服务linkis-ps-datasource时，报如下异常ClassNotFoundException HttpClient：<a class="hash-link" href="#q4启动微服务linkis-ps-datasource时报如下异常classnotfoundexception-httpclient" title="Direct link to heading">#</a></h4><p>具体异常栈：</p><p><img alt="linkis-exception-03.png" src="/zh-CN/assets/images/linkis-exception-03-36fb649e7ef97ceeb949ec89a9b8ffb9.png"></p><p>解法：1.0编译的linkis-metadata-dev-1.0.0.jar存在问题，需要重新编译打包。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q5点击scriptis-数据库不返回数据现象如下"></a>Q5、点击scriptis-数据库，不返回数据，现象如下：<a class="hash-link" href="#q5点击scriptis-数据库不返回数据现象如下" title="Direct link to heading">#</a></h4><p><img alt="page-show-01.png" src="/zh-CN/assets/images/page-show-01-cbec3b1161e52e05e9bcdecadd9de3c1.png"></p><p>解法：原因hive未授权给hadoop用户，授权数据如下：</p><p><img alt="db-config-01.png" src="/zh-CN/assets/images/db-config-01-148b2d1dd324a8082543a67b8a61d031.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q6shell引擎调度执行页面报-insufficient-resource--requesting-available-engine-timeouteningeconnmanager的linkisout报如下错误"></a>Q6、shell引擎调度执行,页面报 Insufficient resource , requesting available engine timeout，eningeconnmanager的linkis.out，报如下错误：<a class="hash-link" href="#q6shell引擎调度执行页面报-insufficient-resource--requesting-available-engine-timeouteningeconnmanager的linkisout报如下错误" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-04.png" src="/zh-CN/assets/images/linkis-exception-04-90263ffdfacbfc69cd63e59955452217.png"></p><p>解法：原因hadoop没有创建/appcom/tmp/hadoop/workDir,通过root用户提前创建，然后给hadoop用户授权即可。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q7shell引擎调度执行时引擎执行目录报如下错误binjavano-such-file-or-directory"></a>Q7、shell引擎调度执行时，引擎执行目录报如下错误/bin/java:No such file or directory：<a class="hash-link" href="#q7shell引擎调度执行时引擎执行目录报如下错误binjavano-such-file-or-directory" title="Direct link to heading">#</a></h4><p><img alt="shell-error-01.png" src="/zh-CN/assets/images/shell-error-01-170fd7884890c07287d87460366b51c6.png"></p><p>解法：本地java的环境变量有问题，需要对java命令做下符号链接。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q8hive引擎调度时报如下错误engineconnpluginnotfoundexceptionerrorcode70063"></a>Q8、hive引擎调度时，报如下错误EngineConnPluginNotFoundException:errorCode:70063<a class="hash-link" href="#q8hive引擎调度时报如下错误engineconnpluginnotfoundexceptionerrorcode70063" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-05.png" src="/zh-CN/assets/images/linkis-exception-05-79ebb69bb11102bfe287ef83ab4131f9.png"></p><p>解法：安装的时候没有修改对应引擎的Version导致，所以默认插入到db里面的引擎类型为默认版本，而编译出来的版本不是默认版本导致。具体修改步骤：cd /appcom/Install/dss-linkis/linkis/lib/linkis-engineconn-plugins/，修改dist目录下的v2.1.1 目录名 修改为v1.2.1  修改plugin目录下的子目录名2.1.1 为默认版本的1.2.1。如果是Spark需要相应修改dist/v2.4.3 和plugin/2.4.3。最后重启engineplugin服务。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q9linkis微服务启动后报如下错误load-balancer-does-not-have-available-server-for-client"></a>Q9、linkis微服务启动后，报如下错误Load balancer does not have available server for client：<a class="hash-link" href="#q9linkis微服务启动后报如下错误load-balancer-does-not-have-available-server-for-client" title="Direct link to heading">#</a></h4><p><img alt="page-show-02.png" src="/zh-CN/assets/images/page-show-02-f1fe09ca6bd0a2b2d7236e033c51a5de.png"></p><p>解法：这个是因为linkis微服务刚启动，还未完成注册，等待1~2分钟，重试即可。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q10hive引擎调度执行时报错如下opertion-failed-nullpointerexception"></a>Q10、hive引擎调度执行时，报错如下opertion failed NullPointerException：<a class="hash-link" href="#q10hive引擎调度执行时报错如下opertion-failed-nullpointerexception" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-06.png" src="/zh-CN/assets/images/linkis-exception-06-a8da09412508967d9b87712a6e97d74a.png"></p><p>解法：服务器缺少环境变量，/etc/profile增加export HIVE_CONF_DIR=/etc/hive/conf;</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q11hive引擎调度时engineconnmanager的错误日志如下method-did-not-existsessionhandler"></a>Q11、hive引擎调度时，engineConnManager的错误日志如下method did not exist:SessionHandler：<a class="hash-link" href="#q11hive引擎调度时engineconnmanager的错误日志如下method-did-not-existsessionhandler" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-07.png" src="/zh-CN/assets/images/linkis-exception-07-437193907ead2d47135f7761017e8730.png"></p><p>解法：hive引擎lib下，jetty jar包冲突，jetty-security、 jetty-server替换为9.4.20；</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q12hive引擎重启后jetty-94的jar包总是被93的替换"></a>Q12、hive引擎重启后，jetty 9.4的jar包总是被9.3的替换<a class="hash-link" href="#q12hive引擎重启后jetty-94的jar包总是被93的替换" title="Direct link to heading">#</a></h4><p>解法：生成引擎实例时，会有jar包缓存，首先需要删除表linkis_engine_conn_plugin_bml_resources hive相关的记录，其次删除目录/appcom/Install/dss-linkis/linkis/lib/linkis-engineconn-plugins/hive/dist下的1.2.1.zip，最后重启engineplugin服务，lib的jar包才会更新成功。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q13hive引擎执行时报如下错误lcomgooglecommoncollectunmodifiableiterator"></a>Q13、hive引擎执行时，报如下错误Lcom/google/common/collect/UnmodifiableIterator：<a class="hash-link" href="#q13hive引擎执行时报如下错误lcomgooglecommoncollectunmodifiableiterator" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-16 13:32:23.304 ERROR [pool-2-thread-1] com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor 140 run - query failed, reason : java.lang.IllegalAccessError: tried to access method com.google.common.collect.Iterators.emptyIterator() Lcom/google/common/collect/UnmodifiableIterator; from class org.apache.hadoop.hive.ql.exec.FetchOperator </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.exec.FetchOperator.&lt;init&gt;(FetchOperator.java:108) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.exec.FetchTask.initialize(FetchTask.java:86) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.compile(Driver.java:629) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.compileInternal(Driver.java:1414) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1543) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1332) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1321) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor$$anon$1.run(HiveEngineConnExecutor.scala:152) [linkis-engineplugin-hive-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor$$anon$1.run(HiveEngineConnExecutor.scala:126) [linkis-engineplugin-hive-dev-1.0.0.jar:?]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>解法：guava包冲突，干掉hive/dist/v1.2.1/lib下的guava-25.1-jre.jar；</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q14hive引擎执行时报错误如下taskexecutionserviceimpl-59-error---orgapachecuratorconnectionconnectionhandlingpolicy-"></a>Q14、hive引擎执行时，报错误如下TaskExecutionServiceImpl 59 error - org/apache/curator/connection/ConnectionHandlingPolicy ：<a class="hash-link" href="#q14hive引擎执行时报错误如下taskexecutionserviceimpl-59-error---orgapachecuratorconnectionconnectionhandlingpolicy-" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-16 16:17:40.649 INFO  [pool-2-thread-1] com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor 42 info - com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor@36a7c96f change status Busy =&gt; Idle.</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-16 16:17:40.661 ERROR [pool-2-thread-1] com.webank.wedatasphere.linkis.engineconn.computation.executor.service.TaskExecutionServiceImpl 59 error - org/apache/curator/connection/ConnectionHandlingPolicy java.lang.NoClassDefFoundError: org/apache/curator/connection/ConnectionHandlingPolicy at org.apache.curator.framework.CuratorFrameworkFactory.builder(CuratorFrameworkFactory.java:78) ~[curator-framework-4.0.1.jar:4.0.1]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.lockmgr.zookeeper.CuratorFrameworkSingleton.getInstance(CuratorFrameworkSingleton.java:59) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.lockmgr.zookeeper.ZooKeeperHiveLockManager.setContext(ZooKeeperHiveLockManager.java:98) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager.getLockManager(DummyTxnManager.java:87) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager.acquireLocks(DummyTxnManager.java:121) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.acquireLocksAndOpenTxn(Driver.java:1237) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.runInternal(Driver.java:1607) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1332) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.hive.ql.Driver.run(Driver.java:1321) ~[hive-exec-2.1.1-cdh6.1.0.jar:2.1.1-cdh6.1.0]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor$$anon$1.run(HiveEngineConnExecutor.scala:152) ~[linkis-engineplugin-hive-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor$$anon$1.run(HiveEngineConnExecutor.scala:126) ~[linkis-engineplugin-hive-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.security.AccessController.doPrivileged(Native Method) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at javax.security.auth.Subject.doAs(Subject.java:422) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1875) ~[hadoop-common-3.0.0-cdh6.3.2.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineplugin.hive.executor.HiveEngineConnExecutor.executeLine(HiveEngineConnExecutor.scala:126) ~[linkis-engineplugin-hive-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1$$anonfun$apply$9$$anonfun$apply$10.apply(ComputationExecutor.scala:145) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1$$anonfun$apply$9$$anonfun$apply$10.apply(ComputationExecutor.scala:144) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.common.utils.Utils$.tryCatch(Utils.scala:48) ~[linkis-common-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1$$anonfun$apply$9.apply(ComputationExecutor.scala:146) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1$$anonfun$apply$9.apply(ComputationExecutor.scala:140) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.immutable.Range.foreach(Range.scala:160) ~[scala-library-2.11.8.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1.apply(ComputationExecutor.scala:139) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor$$anonfun$execute$1.apply(ComputationExecutor.scala:114) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.common.utils.Utils$.tryFinally(Utils.scala:62) ~[linkis-common-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.acessible.executor.entity.AccessibleExecutor.ensureIdle(AccessibleExecutor.scala:42) ~[linkis-accessible-executor-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.acessible.executor.entity.AccessibleExecutor.ensureIdle(AccessibleExecutor.scala:36) ~[linkis-accessible-executor-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor.ensureOp(ComputationExecutor.scala:103) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.execute.ComputationExecutor.execute(ComputationExecutor.scala:114) ~[linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.service.TaskExecutionServiceImpl$$anon$1$$anonfun$run$1.apply$mcV$sp(TaskExecutionServiceImpl.scala:139) [linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.service.TaskExecutionServiceImpl$$anon$1$$anonfun$run$1.apply(TaskExecutionServiceImpl.scala:138) [linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.service.TaskExecutionServiceImpl$$anon$1$$anonfun$run$1.apply(TaskExecutionServiceImpl.scala:138) [linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.common.utils.Utils$.tryCatch(Utils.scala:48) [linkis-common-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.common.utils.Utils$.tryAndWarn(Utils.scala:74) [linkis-common-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at com.webank.wedatasphere.linkis.engineconn.computation.executor.service.TaskExecutionServiceImpl$$anon$1.run(TaskExecutionServiceImpl.scala:138) [linkis-computation-engineconn-dev-1.0.0.jar:?]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511) [?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.FutureTask.run(FutureTask.java:266) [?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.Thread.run(Thread.java:748) [?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Caused by: java.lang.ClassNotFoundException: org.apache.curator.connection.ConnectionHandlingPolicy atjava.net.URLClassLoader.findClass(URLClassLoader.java:381) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.ClassLoader.loadClass(ClassLoader.java:424) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.ClassLoader.loadClass(ClassLoader.java:357) ~[?:1.8.0_181]</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">... 39 more</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>解法：原因是Curator的版本和zookeeper的版本有对应关系。Curator2.X的吧，对于Curator2.X是支持Zookeeper3.4.X的，所以如果目前你是Zookeeper3.4.X的版本，还是使用Curator2.X的吧，比如：2.7.0。参考链接：<a href="https://blog.csdn.net/muyingmiao/article/details/100183768" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/muyingmiao/article/details/100183768</a></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q15python引擎调度时报如下错误python-proces-is-not-alive"></a>Q15、python引擎调度时，报如下错误Python proces is not alive：<a class="hash-link" href="#q15python引擎调度时报如下错误python-proces-is-not-alive" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-08.png" src="/zh-CN/assets/images/linkis-exception-08-b615151d4fc8aab21d01bb3bb17ae685.png"></p><p>解法：服务器安装anaconda3 包管理器，经过对python调试，发现两个问题：（1）缺乏pandas、matplotlib模块，需要手动安装;(2)新版python引擎执行时，依赖python高版本，首先安装python3，其次做下符号链接（如下图），重启engineplugin服务。</p><p><img alt="shell-error-02.png" src="/zh-CN/assets/images/shell-error-02-7a0828687b976e93aeda516f0d11b8cf.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q16spark引擎执行时报如下错误noclassdeffounderror-orgapachehadoophiveqlioorcorcfile"></a>Q16、spark引擎执行时，报如下错误NoClassDefFoundError: org/apache/hadoop/hive/ql/io/orc/OrcFile：<a class="hash-link" href="#q16spark引擎执行时报如下错误noclassdeffounderror-orgapachehadoophiveqlioorcorcfile" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">2021-03-19 15:12:49.227 INFO  [dag-scheduler-event-loop] org.apache.spark.scheduler.DAGScheduler 57 logInfo -ShuffleMapStage 5 (show at &lt;console&gt;:69) failed in 21.269 s due to Job aborted due to stage failure: Task 1 in stage 5.0 failed 4 times, most recent failure: Lost task 1.3 in stage 5.0 (TID 139, cdh03, executor 6):java.lang.NoClassDefFoundError: org/apache/hadoop/hive/ql/io/orc/OrcFile </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$$anonfun$getFileReader$2.apply(OrcFileOperator.scala:75)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$$anonfun$getFileReader$2.apply(OrcFileOperator.scala:73)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.Iterator$$anon$11.next(Iterator.scala:410)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.TraversableOnce$class.collectFirst(TraversableOnce.scala:145)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.AbstractIterator.collectFirst(Iterator.scala:1334)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$.getFileReader(OrcFileOperator.scala:90)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$$anonfun$readSchema$2.apply(OrcFileOperator.scala:99)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$$anonfun$readSchema$2.apply(OrcFileOperator.scala:99)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.Iterator$$anon$11.next(Iterator.scala:410)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.TraversableOnce$class.collectFirst(TraversableOnce.scala:145)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.AbstractIterator.collectFirst(Iterator.scala:1334)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileOperator$.readSchema(OrcFileOperator.scala:99)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileFormat$$anonfun$buildReader$2.apply(OrcFileFormat.scala:160)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.hive.orc.OrcFileFormat$$anonfun$buildReader$2.apply(OrcFileFormat.scala:151)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.datasources.FileFormat$$anon$1.apply(FileFormat.scala:148)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.datasources.FileFormat$$anon$1.apply(FileFormat.scala:132)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:126)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:179)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:103)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(UnknownSource)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$11$$anon$1.hasNext(WholeStageCodegenExec.scala:624)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:409)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:99)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:55)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.scheduler.Task.run(Task.scala:121)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.executor.Executor$TaskRunner$$anonfun$11.apply(Executor.scala:407)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:1408)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:413)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.Thread.run(Thread.java:748)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Caused by: java.lang.ClassNotFoundException: org.apache.hadoop.hive.ql.io.orc.OrcFile </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.net.URLClassLoader.findClass(URLClassLoader.java:381)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.ClassLoader.loadClass(ClassLoader.java:424)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:349)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">at java.lang.ClassLoader.loadClass(ClassLoader.java:357)</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">... 33 more</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>解法：cdh6.3.2集群spark引擎classpath只有/opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/lib/spark/jars，需要新增hive-exec-2.1.1-cdh6.1.0.jar，然后重启spark。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q17spark引擎启动时报queue-default-is-not-exists-in-yarn具体信息如下"></a>Q17、spark引擎启动时，报queue default is not exists in YARN,具体信息如下：<a class="hash-link" href="#q17spark引擎启动时报queue-default-is-not-exists-in-yarn具体信息如下" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-09.png" src="/zh-CN/assets/images/linkis-exception-09-015f3ba93f42edda9be668ee5e570a79.png"></p><p>解法：1.0的linkis-resource-manager-dev-1.0.0.jar拉取队列信息时，解析json有兼容问题，官方同学优化后，重新提供新包，jar包路径：/appcom/Install/dss-linkis/linkis/lib/linkis-computation-governance/linkis-cg-linkismanager/。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q18spark引擎启动时报错-get-the-yarn-queue-information-excepiton获取yarn队列信息异常以及http链接异常"></a>Q18、spark引擎启动时，报错 get the Yarn queue information excepiton.(获取Yarn队列信息异常)以及http链接异常<a class="hash-link" href="#q18spark引擎启动时报错-get-the-yarn-queue-information-excepiton获取yarn队列信息异常以及http链接异常" title="Direct link to heading">#</a></h4><p>解法：yarn的地址配置迁移DB配置，需要增加如下配置：</p><p><img alt="db-config-02.png" src="/zh-CN/assets/images/db-config-02-f13268fb7c543733a5c359d9150963fc.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q19spark引擎调度时首次可以执行成功再次执行报spark-application-sc-has-already-stopped-please-restart-it具体错误如下"></a>Q19、spark引擎调度时，首次可以执行成功，再次执行报Spark application sc has already stopped, please restart it，具体错误如下：<a class="hash-link" href="#q19spark引擎调度时首次可以执行成功再次执行报spark-application-sc-has-already-stopped-please-restart-it具体错误如下" title="Direct link to heading">#</a></h4><p><img alt="page-show-03.png" src="/zh-CN/assets/images/page-show-03-e7a453a712bf9c6b8a580be432de8ab3.png"></p><p>解法：背景是linkis1.0引擎的架构体系有调整，spark session 创建后，为了避免开销、提升执行效率，session是复用的。当我们第一次执行spark.scala时，我们的脚本存在spark.stop()，这个命令会导致新创建的会话被关闭，当再次执行时，会提示会话已关闭，请重启。解决办法：首先所有脚本去掉stop(),其次是执行顺序：先执行default.sql，再执行scalaspark、pythonspark即可。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q20pythonspark调度执行报错initialize-python-executor-failed-classnotfoundexception-orgslf4jimplstaticloggerbinder具体如下"></a>Q20、pythonspark调度执行，报错：initialize python executor failed ClassNotFoundException org.slf4j.impl.StaticLoggerBinder，具体如下：<a class="hash-link" href="#q20pythonspark调度执行报错initialize-python-executor-failed-classnotfoundexception-orgslf4jimplstaticloggerbinder具体如下" title="Direct link to heading">#</a></h4><p><img alt="linkis-exception-10.png" src="/zh-CN/assets/images/linkis-exception-10-592b3282c47555a50b0abfe3cafaa6cf.png"></p><p>解法：原因是spark服务端缺少 slf4j-log4j12-1.7.25.jar,copy上述jar报到/opt/cloudera/parcels/CDH-6.3.2-1.cdh6.3.2.p0.1605554/lib/spark/jars。</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q21pythonspark调度执行报错initialize-python-executor-failedsubmit-version-error具体如下"></a>Q21、pythonspark调度执行，报错：initialize python executor failed，submit-version error，具体如下：<a class="hash-link" href="#q21pythonspark调度执行报错initialize-python-executor-failedsubmit-version-error具体如下" title="Direct link to heading">#</a></h4><p><img alt="shell-error-03.png" src="/zh-CN/assets/images/shell-error-03-477fba3073827e78efc5a1c3dd76c47a.png"></p><p>解法：原因是linkis1.0 pythonSpark引擎获取spark版本代码有bug，修复如下：</p><p><img alt="code-fix-01.png" src="/zh-CN/assets/images/code-fix-01-d9c67cd0e98241135164e4d6ebb06d1e.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q22pythonspark调度执行时报typeerroran-integer-is-requiredgot-type-bytes单独执行拉起引擎的命令跑出的具体如下"></a>Q22、pythonspark调度执行时，报TypeError:an integer is required(got type bytes)(单独执行拉起引擎的命令跑出的)，具体如下：<a class="hash-link" href="#q22pythonspark调度执行时报typeerroran-integer-is-requiredgot-type-bytes单独执行拉起引擎的命令跑出的具体如下" title="Direct link to heading">#</a></h4><p><img alt="shell-error-04.png" src="/zh-CN/assets/images/shell-error-04-3a4c1335ed0c7060e3d9ac6bb2aa08c2.png"></p><p>解法：原因是系统spark和python版本不兼容，python是3.8，spark是2.4.0-cdh6.3.2,spark要求python version&lt;=3.6，降低python至3.6，注释文件/opt/cloudera/parcels/CDH/lib/spark/python/lib/pyspark.zip/pyspark/context.py如下几行：</p><p><img alt="shell-error-05.png" src="/zh-CN/assets/images/shell-error-05-44d72941580d17df2297f7a41ef45390.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_y2LR" id="q23spark引擎是240cdh632python引擎之前因为缺少pandasmatplotlib升级的本地python到38但是spark还不支持python38仅支持36以下"></a>Q23、spark引擎是2.4.0+cdh6.3.2，python引擎之前因为缺少pandas、matplotlib升级的本地python到3.8，但是spark还不支持python3.8，仅支持3.6以下；<a class="hash-link" href="#q23spark引擎是240cdh632python引擎之前因为缺少pandasmatplotlib升级的本地python到38但是spark还不支持python38仅支持36以下" title="Direct link to heading">#</a></h4><p>解法：重新安装python包管理器anaconda2,将python统一降到2.7,安装pandas、matplotlib模块，python引擎、spark引擎均可以正常调度。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/incubator-linkis-website/edit/docusaurus/i18n/zh-CN/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#q1linkis启动报错nosuchmethoderrorgetsessionmanagerlorgeclipsejettyserversessionmanager" class="table-of-contents__link">Q1、linkis启动报错：NoSuchMethodErrorgetSessionManager()Lorg/eclipse/jetty/server/SessionManager</a></li><li><a href="#q2启动微服务linkis-ps-cs时报debuggclasswriter-overrides-final-method-visit" class="table-of-contents__link">Q2、启动微服务linkis-ps-cs时，报DebuggClassWriter overrides final method visit</a></li><li><a href="#q3启动微服务linkis-ps-datasource时jdbcutilsgetdriverclassname-npe" class="table-of-contents__link">Q3、启动微服务linkis-ps-datasource时，JdbcUtils.getDriverClassName NPE</a></li><li><a href="#q4启动微服务linkis-ps-datasource时报如下异常classnotfoundexception-httpclient" class="table-of-contents__link">Q4、启动微服务linkis-ps-datasource时，报如下异常ClassNotFoundException HttpClient：</a></li><li><a href="#q5点击scriptis-数据库不返回数据现象如下" class="table-of-contents__link">Q5、点击scriptis-数据库，不返回数据，现象如下：</a></li><li><a href="#q6shell引擎调度执行页面报-insufficient-resource--requesting-available-engine-timeouteningeconnmanager的linkisout报如下错误" class="table-of-contents__link">Q6、shell引擎调度执行,页面报 Insufficient resource , requesting available engine timeout，eningeconnmanager的linkis.out，报如下错误：</a></li><li><a href="#q7shell引擎调度执行时引擎执行目录报如下错误binjavano-such-file-or-directory" class="table-of-contents__link">Q7、shell引擎调度执行时，引擎执行目录报如下错误/bin/java:No such file or directory：</a></li><li><a href="#q8hive引擎调度时报如下错误engineconnpluginnotfoundexceptionerrorcode70063" class="table-of-contents__link">Q8、hive引擎调度时，报如下错误EngineConnPluginNotFoundException:errorCode:70063</a></li><li><a href="#q9linkis微服务启动后报如下错误load-balancer-does-not-have-available-server-for-client" class="table-of-contents__link">Q9、linkis微服务启动后，报如下错误Load balancer does not have available server for client：</a></li><li><a href="#q10hive引擎调度执行时报错如下opertion-failed-nullpointerexception" class="table-of-contents__link">Q10、hive引擎调度执行时，报错如下opertion failed NullPointerException：</a></li><li><a href="#q11hive引擎调度时engineconnmanager的错误日志如下method-did-not-existsessionhandler" class="table-of-contents__link">Q11、hive引擎调度时，engineConnManager的错误日志如下method did not exist:SessionHandler：</a></li><li><a href="#q12hive引擎重启后jetty-94的jar包总是被93的替换" class="table-of-contents__link">Q12、hive引擎重启后，jetty 9.4的jar包总是被9.3的替换</a></li><li><a href="#q13hive引擎执行时报如下错误lcomgooglecommoncollectunmodifiableiterator" class="table-of-contents__link">Q13、hive引擎执行时，报如下错误Lcom/google/common/collect/UnmodifiableIterator：</a></li><li><a href="#q14hive引擎执行时报错误如下taskexecutionserviceimpl-59-error---orgapachecuratorconnectionconnectionhandlingpolicy-" class="table-of-contents__link">Q14、hive引擎执行时，报错误如下TaskExecutionServiceImpl 59 error - org/apache/curator/connection/ConnectionHandlingPolicy ：</a></li><li><a href="#q15python引擎调度时报如下错误python-proces-is-not-alive" class="table-of-contents__link">Q15、python引擎调度时，报如下错误Python proces is not alive：</a></li><li><a href="#q16spark引擎执行时报如下错误noclassdeffounderror-orgapachehadoophiveqlioorcorcfile" class="table-of-contents__link">Q16、spark引擎执行时，报如下错误NoClassDefFoundError: org/apache/hadoop/hive/ql/io/orc/OrcFile：</a></li><li><a href="#q17spark引擎启动时报queue-default-is-not-exists-in-yarn具体信息如下" class="table-of-contents__link">Q17、spark引擎启动时，报queue default is not exists in YARN,具体信息如下：</a></li><li><a href="#q18spark引擎启动时报错-get-the-yarn-queue-information-excepiton获取yarn队列信息异常以及http链接异常" class="table-of-contents__link">Q18、spark引擎启动时，报错 get the Yarn queue information excepiton.(获取Yarn队列信息异常)以及http链接异常</a></li><li><a href="#q19spark引擎调度时首次可以执行成功再次执行报spark-application-sc-has-already-stopped-please-restart-it具体错误如下" class="table-of-contents__link">Q19、spark引擎调度时，首次可以执行成功，再次执行报Spark application sc has already stopped, please restart it，具体错误如下：</a></li><li><a href="#q20pythonspark调度执行报错initialize-python-executor-failed-classnotfoundexception-orgslf4jimplstaticloggerbinder具体如下" class="table-of-contents__link">Q20、pythonspark调度执行，报错：initialize python executor failed ClassNotFoundException org.slf4j.impl.StaticLoggerBinder，具体如下：</a></li><li><a href="#q21pythonspark调度执行报错initialize-python-executor-failedsubmit-version-error具体如下" class="table-of-contents__link">Q21、pythonspark调度执行，报错：initialize python executor failed，submit-version error，具体如下：</a></li><li><a href="#q22pythonspark调度执行时报typeerroran-integer-is-requiredgot-type-bytes单独执行拉起引擎的命令跑出的具体如下" class="table-of-contents__link">Q22、pythonspark调度执行时，报TypeError:an integer is required(got type bytes)(单独执行拉起引擎的命令跑出的)，具体如下：</a></li><li><a href="#q23spark引擎是240cdh632python引擎之前因为缺少pandasmatplotlib升级的本地python到38但是spark还不支持python38仅支持36以下" class="table-of-contents__link">Q23、spark引擎是2.4.0+cdh6.3.2，python引擎之前因为缺少pandas、matplotlib升级的本地python到3.8，但是spark还不支持python3.8，仅支持3.6以下；</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Linkis</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/zh-CN/docs/next/introduction">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-CN/faq/index">FAQ</a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Releases<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/apache/incubator-linkis" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Issue Tracker<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/apache/incubator-linkis/pulls" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Pull Requests<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Apache Software Foundation</div><ul class="footer__items"><li class="footer__item"><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"><div style="text-align: left;">
          <div>
            <p style="font-family: Avenir-Medium;font-size: 14px;color: #999;line-height: 20px;">Apache Linkis (incubating) is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</p>
          </div>
          <div style="border-top: 1px solid #ccc;min-height: 60px;line-height: 20px;text-align: center;font-family: Avenir-Medium;font-size: 14px;color: #999;display: flex;align-items: center;"><span>Copyright © 2019-2020 The Apache Software Foundation. Apache Linkis, Linkis, and its feather logo are trademarks of The Apache Software Foundation.</span></div>
        </div></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.d57539bc.js"></script>
<script src="/zh-CN/assets/js/main.8f734cad.js"></script>
</body>
</html>